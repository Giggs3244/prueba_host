## microfrontend ejemplo de las lineas que se deben añadir al archivo cloudfrontmicro.tf
## El nombre con el que se aprovisiona el bucket debe especificar dom-sub-app


#Microfront cyc_for_ruta_aprendizaje_front
origin {
  origin_id = "cyc_for_ruta_aprendizaje_front_origin"        #este nombre se especifica con el nombre del bucket y la terminacion "_origin" para este el bucket se crearia como bucket_prueba
  domain_name = "cyc_for_ruta_aprendizaje_front.s3.amazonaws.com"   #de manera similar a la anterior pero con la terminacion ".s3.amazonaws.com" 

  s3_origin_config {
    origin_access_identity = var.microfront_ruta_aprendizaje #aqui se define esta variable "var.microfront_bucket_prueba" la idea es que identifique el microfront que se quiere aprovisionar, el equipo de middlewate asigna el valor de esa variable
  }
}

ordered_cache_behavior {
  path_pattern = "/ruta-aprendizaje/*"         #esta seccion la definen con arquitectura se recomienda un contexto que permita identificar a que microfront hace referencia
  target_origin_id = "cyc_for_ruta_aprendizaje_front_origin"
  min_ttl = "0"
  default_ttl = "0"
  max_ttl = "0"
  compress = "true"
  viewer_protocol_policy = "https-only"
  allowed_methods = ["GET", "HEAD"]
  cached_methods = ["GET", "HEAD"]
  
  forwarded_values {
    cookies {
      forward = "none"
    }
    query_string = "true"
  }

  lambda_function_association {
    event_type   = "origin-request"
    lambda_arn   = var.microfront_lamda_redirect        #el valor de esta variable ya está establecida, en caso de ser necesario se ajusta otra variable para asociar una lambda diferente
    include_body = false
  }
}
